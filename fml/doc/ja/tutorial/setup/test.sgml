<!--
   $FML: test.sgml,v 1.5 2004/04/07 11:07:12 fukachan Exp $
-->


<chapter id="test">
	<title>
	テスト
	</title>

<!--

[fml bible]

9章　fmlの動作確認
        9.1 メールサーバ自体のテストを行う
        9.2 MLへの送信テスト
        9.3 fml自体のテスト
        9.4 テストした形跡を消す（MLの最初期化）

-->


<sect1>
	<title>
	テストの前に
	</title>

<warning>
<para>
テストの前に
newml の際のユーザ重複チェックを効かせるために
postfix の aliases をきちんと追加して下さい。
これをしないと root ＭＬとか作れちゃいます:-)
</para>

<para>
qmail をメールサーバに使っている人は特にやることはないとおもいます。
</para>

</warning>

<para>
以下では、&fmldevel; と MTA が動いているホスト(ahodori.fml.org)をメー
ルサーバと呼びます。
</para>

</sect1>


<sect1>
	<title>
        メールサーバ自体のテストを行う
	</title>

<para>
ＭＬの動作テストの前に、ahodori.fml.org のメールサーバ自体がきちんと動
作していることを確認して下さい。
</para>

<para>
まず、メールサーバに個人宛のメールアドレスを用意しましょう。
ここでは、ユーザ「るど」くん rudo@fml.org を例にとります。
<footnote>
<para>
簡単に用意するには、ユーザ rudo くんを作ればよいでしょう。
</para>
</footnote>
</para>

<para>
まず、メールサーバ以外のホストから rudo@fml.org へメールが届くか？(到
達性)を確認して下さい。つまり、メールサーバ以外のホストから
rudo@fml.org くんにメールを出し、ちゃんと受信できているかを確認してく
ださい。もし受けとれないなら、そもそも Postfix の設定が間違っています。
</para>

<para>
次に、そのホスト上で rudo くんにメールが届くかも試して下さい。
つまり ahodori の上で rudo@fml.org へメールを出してください。
<screen>
% echo test |Mail rudo@fml.org
</screen>
この場合も、
もし受けとれないなら、そもそも Postfix の設定が間違っています。
</para>

<para>
Postfix の基本設定が正しいと確認できたらＭＬのテストに進んで下さい。
</para>

</sect1>


<sect1>
	<title>
        ML への送信テスト
	</title>

<para>
elena ML (ここでは elena@fml.org)を作成し、
rudo@fml.org を登録して下さい。
<screen>
% su fml
% makefml newml elena
% makefml add elena rudo@fml.org
</screen>
</para>

<para>
前節と同様に、ホスト外から、そしてホストの上から、それぞれ
elena@fml.org へテストメールを出してみて下さい。 
この時、テストメールの From: が rudo@fml.org になっていないと
はじかれます。
メンバー以外からのメールは受け付けないからです。
注意して下さい。
</para>

<sect2>
	<title>
	確認事項
	</title>

<para>
もし、うまくいかない時は以下のような項目を確認して下さい。
<screen>
メールサーバのログを確認する
fml のログにエラーメッセージがないか
fml はメールサーバに配送するべきメール(記事)を渡したか？
メールサーバは配送処理に成功したか？
</screen>
</para>

</sect2>

</sect1>


<sect1>
	<title>
        fml8 自体のテスト
	</title>

<para>
fml4 には makefml test というコマンドがありますが、
fml8 には、今のところ、それに相当するものはありません。
</para>

<para>
作らなきゃ…
</para>

</sect1>


<sect1>
	<title>
        テストした形跡を消す（MLの再初期化）
	</title>

<para>
テストの形跡を消すには、ＭＬを消して作り直せば良いでしょう。
<screen>
% su fml
% makefml rmml test
% makefml newml test
</screen>
今、テストしたＭＬのホームディレクトリは
/var/spool/ml/@test.日付
に残っています。
テストで使っただけですので、これも消してしまってかまいません。
<screen>
% su fml
% rm -fr /var/spool/ml/@test.日付
</screen>
</para>

</sect1>


</chapter>
