<!--
	$FML$
-->

<chapter id="overview"> 
<title> おおまかな流れ </title>

<sect1>
	<title> 概要 </title>

<warning>
<para>
fml-devel 
は動くとはいえ、まだまだ開発者向けのプログラムであることに注意して
下さい。実運用には 
	<ulink url="http://www.fml.org/fml/">
	fml 4.0
	</ulink>
系を御利用下さい。
</para>
</warning>


<para>
以下で、特に触れていない概念(例: ＭＬとは？)については fml 4.0 と同様
です。4.0 の資料を適宜参照して下さい。
</para>

<para>
いつものように elena ＭＬを例にとりましょう。
elena ＭＬを作成するまでのおおまかな流れは次のようになります。
</para>


<orderedlist>
   <listitem>
	<para>
		<link linkend="download">
		ソースをダウンロードをする。
		</link>
	</para>
   </listitem>

   <listitem>
	<para>
		<link linkend="install">
		ユーザ root でインストールをする。
		</link>

		インストーラは /usr/local/bin に 
			fmldoc fmlconf fmlticket makefml 
		をインストールします。

		これらは、
		実は、
		/usr/local/libexec/fml の下の実体を呼び出す単なる
		wrapper です。

	なお、インストールされるコマンドの一覧は
		<link linkend="available">
		ここ
		</link>
	にあります。
	</para>
   </listitem>


   <listitem>
	<para>
		<link linkend="guide.newml">
		ユーザ fml で elena ＭＬを作る。 
		</link>
	</para>
   </listitem>


   <listitem>
	<para>
		<link linkend="guide.config.cf">
		カスタマイズをする。 
		</link>
	</para>
   </listitem>

</orderedlist>

</sect1>




<sect1 id="guide.newml">

   <title> ＭＬを作る </title>

<para>
fml 4.0 と同様です。 
が、config.cf という設定ファイルをインストールしてくれるだけです。

インストール後は、次のようになるはずです。
<screen>
% su fml
% makefml newml elena
% ls /var/spool/ml/elena
config.cf
</screen>
</para>


<para>
とりあえず config.cf の先頭の ml_domain と ml_name を
自分のＭＬに変更して下さい。
まだ自動変換できません（そのうちします）。
</para>


<para>
<screen>
config.cf の例

# ドメイン名 (参照: 以下のアドレスを見よ $ml_domain がこの値に展開される)
ml_domain           = fml.org

# ML の名前
ml_name		    = elena		

# 管理者のアドレス
maintainer	    = $ml_name-admin@$ml_domain

# 投稿用のアドレス
address_for_post    = $ml_name@$ml_domain

# コマンド用のアドレス
address_for_command = $ml_name-ctl@$ml_domain
</screen>
</para>


<para>
include include-ctl aliases も fml 4.0 と同様です。
が、まだ、makefml newml で自動生成できるようになっていません _o_
</para>

<para>
/var/spool/ml/elena/include ファイルは
<screen>
"| /usr/local/libexec/fml/fml.pl /var/spool/ml/elena"
</screen>

/var/spool/ml/elena/include-ctl ファイルは
<screen>
"| /usr/local/libexec/fml/fml.pl /var/spool/ml/elena --ctladdr"
</screen>
</para>


<para>
aliases への追加は次のようにして下さい。
<screen>
elena: :include:/var/spool/ml/elena/include
elena-ctl: :include:/var/spool/ml/elena/include-ctl
elena-admin: fml
owner-elena: fml
owner-elena-ctl: fml
</screen>
</para>

</sect1>



<sect1 id="guide.config.cf">

<title> カスタマイズをする </title>

<para>
elena ＭＬの設定のカスタマイズは /var/spool/ml/elena/config.cf を編集
して下さい。フォーマットは fml 4.0 の cf に近いですが、postfix の設定
ファイルと同様です。
</para>

<para>
必要な項目を追加して下さい。それ以外はデフォルト値が使われます。
デフォルト値はインストールしたバージョンに依存し、

<screen>
/etc/fml/defaults/バージョン番号/default_config.cf
</screen>

というファイルで定義されています。

これは perl のライブラリが /usr/local/lib/perl/5.00503/ のように
バージョン番号付のディレクトリに置かれるのと同様です。
</para>

<para>
インストールした fml のバージョンごとに全部別のディレクトリに
置かれることに注意して下さい。
この仕組みのおかげでアップグレードしても元に戻すのが簡単です。
</para>

</sect1>

</chapter>
