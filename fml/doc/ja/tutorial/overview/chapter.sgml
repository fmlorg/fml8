<!--
	$FML: chapter.sgml,v 1.2 2001/05/07 03:16:25 fukachan Exp $
-->

<chapter id="overview"> 
	<title>
	おおまかな流れ
	</title>

<sect1>
	<title> 概要 </title>

<warning>
<para>
fml-devel 
は動くとはいえ、まだまだ開発者向けのプログラムであることに注意して
下さい。実運用には 
	<ulink url="http://www.fml.org/fml/">
	&fml4;
	</ulink>
系を御利用下さい。
</para>
</warning>


<para>
以下で、特に触れていない概念(例: ＭＬとは？)については &fml4; と同様
です。4.0 の資料(
	<ulink url="http://www.fml.org/fml/">
	http://www.fml.org/fml/
	</ulink>
	や
	&fmlbible;
)を適宜参照して下さい。
</para>

<para>
さて、いつものように elena ＭＬの作成過程を例にとりましょう。
おおまかな流れは次のようになります。
</para>


<orderedlist>
   <listitem>
	<para>
		<link linkend="download">
		ソースをダウンロードする。
		</link>
	</para>
   </listitem>

   <listitem>
	<para>
		<link linkend="install">
		ユーザ root でインストールをする。
		</link>
	</para>

	<para>
		インストーラは /usr/local/bin に 
		<link linkend="available">
		fmldoc fmlconf fmlticket makefml 
		</link>
		をインストールします。
	</para>

	<para>
		実は、
		これらは
		/usr/local/libexec/fml の下の実体を呼び出す単なる
		wrapper です。
	</para>
   </listitem>


   <listitem>
	<para>
		<link linkend="guide.newml">
		ユーザ fml で elena ＭＬを作る。 
		</link>
	</para>
   </listitem>


   <listitem>
	<para>
		/etc/mail/aliases の設定などをする
	</para>
   </listitem>


   <listitem>
	<para>
		テストをする。
	</para>
   </listitem>


   <listitem>
	<para>
		<link linkend="guide.config.cf">
		カスタマイズをする。 
		</link>
	</para>
   </listitem>

</orderedlist>

<warning>
<para>
	&fml4; と異なり root でインストールすることに注意して下さい。
</para>
</warning>

</sect1>


<!-- ============================================================= -->
<sect1 id="guide.newml">

   <title> ＭＬを作る </title>

<para>
&fml4; と同様です。 
ですが、
現状では config.cf という設定ファイルをインストールしてくれるだけです。

インストール後は、次のようになるはずです。
<screen>
% su fml
% makefml newml elena
% ls /var/spool/ml/elena
config.cf
</screen>
</para>


<para>
とりあえず config.cf の先頭の ml_domain と ml_name を
自分のＭＬに変更して下さい。
まだ自動変換できません（そのうちできるようにします）。
</para>


<para>
<screen>
config.cf の例

# ドメイン名 (参照: 以下のアドレスを見よ $ml_domain がこの値に展開される)
ml_domain           = fml.org

# ML の名前
ml_name		    = elena		

# 管理者のアドレス
maintainer	    = $ml_name-admin@$ml_domain

# 投稿用のアドレス
address_for_post    = $ml_name@$ml_domain

# コマンド用のアドレス
address_for_command = $ml_name-ctl@$ml_domain
</screen>
</para>


<para>
include include-ctl aliases も &fml4; と同様です。
が、まだ、makefml newml で自動生成できるようになっていません _o_
</para>

<para>
/var/spool/ml/elena/include ファイルは
<screen>
"| /usr/local/libexec/fml/fml.pl /var/spool/ml/elena"
</screen>

/var/spool/ml/elena/include-ctl ファイルは
<screen>
"| /usr/local/libexec/fml/fml.pl /var/spool/ml/elena --ctladdr"
</screen>
</para>


<para>
aliases への追加は次のようにして下さい。
<screen>
elena: :include:/var/spool/ml/elena/include
elena-ctl: :include:/var/spool/ml/elena/include-ctl
elena-admin: fml
owner-elena: fml
owner-elena-ctl: fml
</screen>
</para>

</sect1>



<sect1 id="guide.config.cf">

<title> カスタマイズをする </title>

<para>
elena ＭＬの設定のカスタマイズは /var/spool/ml/elena/config.cf を編集
して下さい。フォーマットは &fml4; の cf に近いです。
むしろ postfix の設定ファイルと同様という方が良いでしょう。
</para>

<para>
適宜必要な項目を追加して下さい。
指定しない場合はデフォルト値が使われます。
デフォルト値はインストールしたバージョンに依存し、
<screen>
/etc/fml/defaults/バージョン番号/default_config.cf
</screen>
というファイルで定義されています。
</para>

<para>
これは perl のライブラリが /usr/local/lib/perl/5.00503/ のように
バージョン番号付のディレクトリに置かれるのと同様です。
</para>

<para>
インストール先も fml のバージョンごとに
別のディレクトリになることに注意して下さい。
この仕組みのおかげでアップグレードしても元に戻すのが簡単です。
これは &fml5; の特徴です。
</para>

</sect1>

</chapter>
